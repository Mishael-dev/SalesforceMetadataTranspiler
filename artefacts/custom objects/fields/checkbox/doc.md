# Field Documentation: Checkbox

This document breaks down the Salesforce **Checkbox Custom Field XML** and separates the metadata into categories based on how the transpiler, LLM, and UI will interact with them.

---

Stored in `checkbox__c.field-meta.xml`.

## 1. The Outer Container

This is the Salesforce Metadata API wrapper that defines a single custom field. It provides the XML namespace and ensures the field is correctly interpreted during deployment.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<CustomField xmlns="http://soap.sforce.com/2006/04/metadata">
    <!-- Field content -->
</CustomField>
```

---

## 2. Core Field Configuration (LLM Generated)

These elements define the **business intent and semantic meaning** of the Checkbox field. They must be explicitly generated by the LLM because they directly affect how the field behaves and is understood by users.

```xml
<fullName>checkbox__c</fullName>
<label>checkbox</label>
<description>checkbox description</description>
<inlineHelpText>checkbox help text</inlineHelpText>
<defaultValue>false</defaultValue>
```

### Element Responsibilities

* **`fullName`**

  * Defines the API name of the field.
  * Must be unique within the object and end with `__c`.

* **`label`**

  * Human-readable name displayed in the Salesforce UI.

* **`description`**

  * Optional documentation for admins and developers.

* **`inlineHelpText`**

  * Contextual help text displayed to end users.

* **`defaultValue`**

  * Defines the default boolean state when a new record is created.
  * For Checkbox fields, valid values are `true` or `false`.

---

## 3. Supporting Features (React Flow UI)

These elements control optional platform behaviors. They are surfaced in the UI as toggles and are not part of the core field intent.

```xml
<trackHistory>false</trackHistory>
```

### Element Responsibilities

* **`trackHistory`**

  * Enables or disables field history tracking.
  * Applicable to Checkbox fields.

---

## 4. Others (Transpiler Injected)

These elements are required by Salesforce or are injected automatically by the transpiler to ensure a valid metadata definition.

```xml
<type>Checkbox</type>
<trackTrending>false</trackTrending>
```

### Element Responsibilities

* **`type`**

  * Declares the Salesforce field type.
  * Must be exactly `Checkbox`.

* **`trackTrending`**

  * Controls whether the field is tracked for trend analytics.
  * Not user-configurable in most orgs and defaults to `false`.

---
## Json Shape

This section represents the core field definition as a JSON object.

```json
{
  "type": "Checkbox",
  "label": "checkbox",
  "fullName": "checkbox__c",
  "description": "checkbox description",
  "inlineHelpText": "checkbox help text",
  "defaultValue": false
}
```
---
## 5. Validation Rules

This section documents the validation rules applied to **Checkbox** fields at each validation layer in the transpiler pipeline.

### Level 1: Structural Validation (The Shape)

Ensures the JSON structure is valid and complete.

* `type` must be exactly `Checkbox`.
* `fullName` must be a non-empty string ending with `__c`.
* `label` must be a non-empty string.
* `defaultValue` must be a boolean (`true` or `false`).
* `trackHistory` and `trackTrending` must be boolean values if present.

---

### Level 2: Logical Validation (The Context)

Ensures internal consistency and correct field behavior.

* `defaultValue` must be either `true` or `false` (no expressions or formulas allowed).
* Checkbox fields **cannot** have precision, scale, length, or formula-related attributes.
* `trackHistory` may only be enabled if Field History Tracking is enabled on the object.

---

### Level 3: Platform Constraints (The Linter)

Enforces Salesforce hard limits and prohibitions that cannot be reliably enforced via schema validation alone.

* `fullName` (excluding `__c`) must not exceed **40 characters**.
* `label` must not exceed **40 characters**.
* `inlineHelpText` must not exceed **255 characters**.
* Checkbox fields **cannot** be marked as `externalId` or `unique`.
* Checkbox fields cannot be encrypted.
* Checkbox fields cannot be used as roll-up summary targets.

Violations at this level should fail fast with clear, actionable error messages.

---

### Level 4: State & Conflict Validation (The Pre-Flight)

Validations that require awareness of the target Salesforce org.

* Verify no existing field with the same `fullName` exists on the target object.
* If the field already exists:

  * Prevent changes to `type`.
  * Prevent conversion from Checkbox to another field type.
* Validate that the target object is not locked by a managed package.
* Ensure no namespace collisions exist in namespaced orgs.

Failures at this level must be surfaced as **deployment conflicts**, not schema errors.

---

## 6. Summary Table for Transpiler Logic

| XML Tag            | JSON Key       | Source | Default Value |
| ------------------ | -------------- | ------ | ------------- |
| `<fullName>`       | fullName       | LLM    | Derived       |
| `<label>`          | label          | LLM    | N/A           |
| `<description>`    | description    | LLM    | Empty String  |
| `<inlineHelpText>` | inlineHelpText | LLM    | Empty String  |
| `<defaultValue>`   | defaultValue   | LLM    | false         |
| `<trackHistory>`   | trackHistory   | UI     | false         |
| `<type>`           | type           | System | Checkbox      |
| `<trackTrending>`  | trackTrending  | System | false         |
